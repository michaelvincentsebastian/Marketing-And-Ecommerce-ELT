2025-12-13 13:13:49,027 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:492)
2025-12-13 13:13:50,540 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:494)
2025-12-13 13:13:50,760 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:482)
2025-12-13 13:13:50,854 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0000_baseline' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0000_baseline.py'> (migrator.py:185)
2025-12-13 13:13:50,897 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0061_mysql_fix_blob_text_type.py'> (migrator.py:185)
2025-12-13 13:13:50,897 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0062_add_model_gateway.py'> (migrator.py:185)
2025-12-13 13:13:50,897 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0063_change_signals.py'> (migrator.py:185)
2025-12-13 13:13:50,898 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0064_join_when_matched_strings.py'> (migrator.py:185)
2025-12-13 13:13:50,898 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0065_add_model_optimize.py'> (migrator.py:185)
2025-12-13 13:13:50,898 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0066_add_auto_restatements.py'> (migrator.py:185)
2025-12-13 13:13:50,907 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0067_add_tsql_date_full_precision.py'> (migrator.py:185)
2025-12-13 13:13:50,908 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:185)
2025-12-13 13:13:50,908 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0069_update_dev_table_suffix.py'> (migrator.py:185)
2025-12-13 13:13:50,908 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0070_include_grains_in_metadata_hash.py'> (migrator.py:185)
2025-12-13 13:13:50,908 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0071_add_dev_version_to_intervals.py'> (migrator.py:185)
2025-12-13 13:13:50,911 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0072_add_environment_statements.py'> (migrator.py:185)
2025-12-13 13:13:50,918 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0073_remove_symbolic_disable_restatement.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0074_add_partition_by_time_column_property.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0075_remove_validate_query.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0076_add_cron_tz.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0077_fix_column_type_hash_calculation.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0078_warn_if_non_migratable_python_env.py'> (migrator.py:185)
2025-12-13 13:13:50,919 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0079_add_gateway_managed_property.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0081_update_partitioned_by.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0084_normalize_quote_when_matched_and_merge_filter' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0084_normalize_quote_when_matched_and_merge_filter.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0085_deterministic_repr' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0085_deterministic_repr.py'> (migrator.py:185)
2025-12-13 13:13:50,922 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0086_check_deterministic_bug' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0086_check_deterministic_bug.py'> (migrator.py:185)
2025-12-13 13:13:50,923 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0087_normalize_blueprint_variables' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0087_normalize_blueprint_variables.py'> (migrator.py:185)
2025-12-13 13:13:50,923 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0088_warn_about_variable_python_env_diffs' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0088_warn_about_variable_python_env_diffs.py'> (migrator.py:185)
2025-12-13 13:13:50,923 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0089_add_virtual_environment_mode' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0089_add_virtual_environment_mode.py'> (migrator.py:185)
2025-12-13 13:13:50,923 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0090_add_forward_only_column' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0090_add_forward_only_column.py'> (migrator.py:185)
2025-12-13 13:13:50,926 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0091_on_additive_change' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0091_on_additive_change.py'> (migrator.py:185)
2025-12-13 13:13:50,926 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0092_warn_about_dbt_data_type_diff' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0092_warn_about_dbt_data_type_diff.py'> (migrator.py:185)
2025-12-13 13:13:50,926 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0093_use_raw_sql_in_fingerprint' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0093_use_raw_sql_in_fingerprint.py'> (migrator.py:185)
2025-12-13 13:13:50,926 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0094_add_dev_version_and_fingerprint_columns' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0094_add_dev_version_and_fingerprint_columns.py'> (migrator.py:185)
2025-12-13 13:13:50,932 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0095_warn_about_dbt_raw_sql_diff' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0095_warn_about_dbt_raw_sql_diff.py'> (migrator.py:185)
2025-12-13 13:13:50,932 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0096_remove_plan_dags_table' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0096_remove_plan_dags_table.py'> (migrator.py:185)
2025-12-13 13:13:50,933 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0097_add_dbt_name_in_node' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0097_add_dbt_name_in_node.py'> (migrator.py:185)
2025-12-13 13:13:50,934 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0098_add_dbt_node_info_in_node' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0098_add_dbt_node_info_in_node.py'> (migrator.py:185)
2025-12-13 13:13:50,934 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0099_add_last_altered_to_intervals' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0099_add_last_altered_to_intervals.py'> (migrator.py:185)
2025-12-13 13:13:50,936 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0100_add_grants_and_grants_target_layer' from 'B:\\GitHub Repository\\Marketing-And-Ecommerce-ELT\\.venv\\Lib\\site-packages\\sqlmesh\\migrations\\v0100_add_grants_and_grants_target_layer.py'> (migrator.py:185)
2025-12-13 13:13:50,938 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:207)
2025-12-13 13:13:50,941 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:224)
2025-12-13 13:13:50,943 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:217)
2025-12-13 13:13:55,358 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-12-13 13:13:55,473 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-13 13:13:55,484 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__proyek_etl_saya' (evaluator.py:1449)
2025-12-13 13:13:55,486 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__proyek_etl_saya" (base.py:2619)
2025-12-13 13:13:55,489 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1449)
2025-12-13 13:13:55,493 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2619)
2025-12-13 13:13:55,497 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-13 13:13:55,520 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-12-13 13:13:55,521 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,524 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,537 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2437004170', 'sqlmesh_example__full_model__635791289', 'sqlmesh_example__incremental_model__3572673861') (base.py:2619)
2025-12-13 13:13:55,576 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__proyek_etl_saya (evaluator.py:1616)
2025-12-13 13:13:55,577 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,582 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,598 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__proyek_etl_saya') AND table_name IN ('proyek_etl_saya__pendapatan_harian__2187986930') (base.py:2619)
2025-12-13 13:13:55,660 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."proyek_etl_saya"."pendapatan_harian": 2174912353> (evaluator.py:711)
2025-12-13 13:13:55,668 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."proyek_etl_saya"."pendapatan_harian": 2174912353> (evaluator.py:952)
2025-12-13 13:13:55,677 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-12 00:00:00, 2025-12-13 00:00:00) into db.sqlmesh__proyek_etl_saya.proyek_etl_saya__pendapatan_harian__2187986930' (evaluator.py:984)
2025-12-13 13:13:55,678 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ DESCRIBE "db"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__2187986930" (base.py:2619)
2025-12-13 13:13:55,680 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,682 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-13 13:13:55,687 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE OR REPLACE TABLE "db"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__2187986930" AS SELECT "tanggal" AS "tanggal", "produk" AS "produk", "jumlah" * "harga" AS "total_pendapatan", 'IDR' AS "mata_uang" FROM "transaksi" AS "transaksi" (base.py:2619)
2025-12-13 13:13:55,692 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 1656223088> (evaluator.py:711)
2025-12-13 13:13:55,695 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2437004170' (evaluator.py:2042)
2025-12-13 13:13:55,699 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,702 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-13 13:13:55,705 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2619)
2025-12-13 13:13:55,764 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,766 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,772 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2437004170') (base.py:2619)
2025-12-13 13:13:55,810 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,813 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-13 13:13:55,818 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS SELECT CAST("id" AS INT) AS "id", CAST("item_id" AS INT) AS "item_id", CAST("event_date" AS DATE) AS "event_date" FROM (SELECT "id", "item_id", "event_date" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__2437004170_iekrlhx8") AS "_subquery" (base.py:2619)
2025-12-13 13:13:55,822 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__2437004170_iekrlhx8" (base.py:2619)
2025-12-13 13:13:55,826 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-12 00:00:00, 2025-12-13 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 1656223088> (facade.py:637)
2025-12-13 13:13:55,827 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 1656223088> (interval.py:215)
2025-12-13 13:13:55,872 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2571398457> (evaluator.py:870)
2025-12-13 13:13:55,921 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:2042)
2025-12-13 13:13:55,928 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:55,934 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-13 13:13:55,938 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2619)
2025-12-13 13:13:55,942 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:2064)
2025-12-13 13:13:55,945 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2619)
2025-12-13 13:13:55,949 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2571398457> (evaluator.py:711)
2025-12-13 13:13:55,950 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2571398457> (evaluator.py:952)
2025-12-13 13:13:55,970 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00, 2025-12-13 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:984)
2025-12-13 13:13:55,972 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-12-12' AS DATE) (base.py:2619)
2025-12-13 13:13:55,977 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-12-12' AS DATE) AND "seed_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-12-12' AS DATE) (base.py:2619)
2025-12-13 13:13:55,981 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2020-01-01 00:00:00, 2025-12-13 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2571398457> (facade.py:637)
2025-12-13 13:13:55,981 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 2571398457> (interval.py:215)
2025-12-13 13:13:56,013 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4270737588> (evaluator.py:711)
2025-12-13 13:13:56,014 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4270737588> (evaluator.py:952)
2025-12-13 13:13:56,030 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-12 00:00:00, 2025-12-13 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:984)
2025-12-13 13:13:56,034 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:13:56,036 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-13 13:13:56,040 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS SELECT CAST("item_id" AS INT) AS "item_id", CAST("num_orders" AS BIGINT) AS "num_orders" FROM (SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" AS "incremental_model" GROUP BY "incremental_model"."item_id") AS "_subquery" (base.py:2619)
2025-12-13 13:13:56,064 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4270737588> (evaluator.py:603)
2025-12-13 13:13:56,066 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-12-13 13:13:56,083 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 3a75ef6cfdf147769e6e4ff52590f09f */ SELECT COUNT(*) FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS "sqlmesh_example__full_model__635791289" WHERE "item_id" < 0) AS "audit" (base.py:2619)
2025-12-13 13:13:56,084 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-12 00:00:00, 2025-12-13 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4270737588> (facade.py:637)
2025-12-13 13:13:56,085 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4270737588> (interval.py:215)
2025-12-13 13:13:56,119 - MainThread - sqlmesh.core.scheduler - INFO - Execution failed for node EvaluateNode(snapshot_name='"db"."proyek_etl_saya"."pendapatan_harian"', interval=(1765497600000, 1765584000000), batch_index=0) (scheduler.py:618)
Traceback (most recent call last):
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\utils\concurrency.py", line 234, in sequential_apply_to_dag
    fn(node)
    ~~^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\scheduler.py", line 554, in run_node
    audit_results = self.evaluate(
        snapshot=snapshot,
    ...<9 lines>...
        selected_models=selected_models,
    )
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\scheduler.py", line 229, in evaluate
    wap_id = self.snapshot_evaluator.evaluate(
        snapshot,
    ...<9 lines>...
        **kwargs,
    )
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 186, in evaluate
    result = self._evaluate_snapshot(
        start=start,
    ...<9 lines>...
        **kwargs,
    )
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 821, in _evaluate_snapshot
    self._render_and_insert_snapshot(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        start=start,
        ^^^^^^^^^^^^
    ...<10 lines>...
        batch_index=batch_index,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 1041, in _render_and_insert_snapshot
    apply(query_or_df, index)
    ~~~~~^^^^^^^^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 990, in apply
    evaluation_strategy.insert(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        table_name=target_table_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<12 lines>...
        is_snapshot_deployable=is_snapshot_deployable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 2418, in insert
    self._replace_query_for_model(model, table_name, query_or_df, render_kwargs, **kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\snapshot\evaluator.py", line 2155, in _replace_query_for_model
    self.adapter.replace_query(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        name,
        ^^^^^
    ...<10 lines>...
        source_columns=source_columns,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\shared.py", line 318, in internal_wrapper
    return func(*list_args, **kwargs)
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\base.py", line 524, in replace_query
    return self._create_table_from_source_queries(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        target_table,
        ^^^^^^^^^^^^^
    ...<5 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\base.py", line 931, in _create_table_from_source_queries
    self._create_table(
    ~~~~~~~~~~~~~~~~~~^
        schema if schema else table,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\duckdb.py", line 188, in _create_table
    super()._create_table(
    ~~~~~~~~~~~~~~~~~~~~~^
        table_name_or_schema,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<8 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\base.py", line 974, in _create_table
    self.execute(
    ~~~~~~~~~~~~^
        self._build_create_table_exp(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        track_rows_processed=track_rows_processed,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\base.py", line 2596, in execute
    self._execute(sql, track_rows_processed, **kwargs)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\engine_adapter\base.py", line 2628, in _execute
    self.cursor.execute(sql, **kwargs)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
_duckdb.CatalogException: Catalog Error: Table with name transaksi does not exist!
Did you mean "pg_constraint"?

LINE 1: ..." * "harga" AS "total_pendapatan", 'IDR' AS "mata_uang" FROM "transaksi" AS "transaksi"
                                                                        ^

The above exception was the direct cause of the following exception:

sqlmesh.utils.concurrency.NodeExecutionFailedError: Execution failed for node EvaluateNode(snapshot_name='"db"."proyek_etl_saya"."pendapatan_harian"', interval=(1765497600000, 1765584000000), batch_index=0)
2025-12-13 13:13:56,139 - MainThread - sqlmesh.core.context - INFO - Plan application failed. (context.py:1772)
Traceback (most recent call last):
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\context.py", line 1764, in apply
    self._apply(plan, circuit_breaker)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\context.py", line 2557, in _apply
    self._scheduler.create_plan_evaluator(self).evaluate(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        plan.to_evaluatable(), circuit_breaker=circuit_breaker
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\plan\evaluator.py", line 105, in evaluate
    self._evaluate_stages(plan_stages, plan)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\plan\evaluator.py", line 125, in _evaluate_stages
    handler(stage, plan)
    ~~~~~~~^^^^^^^^^^^^^
  File "B:\GitHub Repository\Marketing-And-Ecommerce-ELT\.venv\Lib\site-packages\sqlmesh\core\plan\evaluator.py", line 264, in visit_backfill_stage
    raise PlanError("Plan application failed.")
sqlmesh.utils.errors.PlanError: Plan application failed.
2025-12-13 13:13:56,197 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
