2025-12-13 13:22:22,480 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'./warehouse.db'} (connection.py:492)
2025-12-13 13:22:24,022 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:494)
2025-12-13 13:22:24,211 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: ./warehouse.db (connection.py:482)
2025-12-13 13:22:26,716 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-12-13 13:22:26,762 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-13 13:22:26,766 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'warehouse.sqlmesh__proyek_etl_saya' (evaluator.py:1449)
2025-12-13 13:22:26,767 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE SCHEMA IF NOT EXISTS "warehouse"."sqlmesh__proyek_etl_saya" (base.py:2619)
2025-12-13 13:22:26,768 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'warehouse.sqlmesh__sqlmesh_example' (evaluator.py:1449)
2025-12-13 13:22:26,769 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE SCHEMA IF NOT EXISTS "warehouse"."sqlmesh__sqlmesh_example" (base.py:2619)
2025-12-13 13:22:26,770 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-13 13:22:26,775 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-12-13 13:22:26,775 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,777 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,779 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'warehouse' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_pendapatan__2581483422') (base.py:2619)
2025-12-13 13:22:26,832 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.sqlmesh__proyek_etl_saya (evaluator.py:1616)
2025-12-13 13:22:26,833 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,834 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,837 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'warehouse' AND table_schema = 'sqlmesh__proyek_etl_saya') AND table_name IN ('proyek_etl_saya__pendapatan_harian__1372347723') (base.py:2619)
2025-12-13 13:22:26,847 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."sqlmesh_example"."seed_pendapatan": 2574392110> (evaluator.py:711)
2025-12-13 13:22:26,849 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'warehouse.sqlmesh__sqlmesh_example.sqlmesh_example__seed_pendapatan__2581483422' (evaluator.py:2042)
2025-12-13 13:22:26,850 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,853 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'warehouse' (base.py:2619)
2025-12-13 13:22:26,857 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE TABLE IF NOT EXISTS "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_pendapatan__2581483422" ("id" INT, "produk" TEXT, "jumlah" INT, "harga" INT, "tanggal" DATE) (base.py:2619)
2025-12-13 13:22:26,896 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,901 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,908 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'warehouse' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_pendapatan__2581483422') (base.py:2619)
2025-12-13 13:22:26,934 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,938 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'warehouse' (base.py:2619)
2025-12-13 13:22:26,943 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE TABLE "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_pendapatan__2581483422" AS SELECT CAST("id" AS INT) AS "id", CAST("produk" AS TEXT) AS "produk", CAST("jumlah" AS INT) AS "jumlah", CAST("harga" AS INT) AS "harga", CAST("tanggal" AS DATE) AS "tanggal" FROM (SELECT "id", "produk", "jumlah", "harga", "tanggal" FROM "warehouse"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_pendapatan__2581483422_qm316nt2") AS "_subquery" (base.py:2619)
2025-12-13 13:22:26,947 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ DROP TABLE IF EXISTS "warehouse"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_pendapatan__2581483422_qm316nt2" (base.py:2619)
2025-12-13 13:22:26,949 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-12 00:00:00, 2025-12-13 00:00:00) for snapshot SnapshotId<"warehouse"."sqlmesh_example"."seed_pendapatan": 2574392110> (facade.py:637)
2025-12-13 13:22:26,950 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."sqlmesh_example"."seed_pendapatan": 2574392110> (interval.py:215)
2025-12-13 13:22:26,977 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."proyek_etl_saya"."pendapatan_harian": 3265057870> (evaluator.py:711)
2025-12-13 13:22:26,978 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."proyek_etl_saya"."pendapatan_harian": 3265057870> (evaluator.py:952)
2025-12-13 13:22:26,991 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-12 00:00:00, 2025-12-13 00:00:00) into warehouse.sqlmesh__proyek_etl_saya.proyek_etl_saya__pendapatan_harian__1372347723' (evaluator.py:984)
2025-12-13 13:22:26,992 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:26,995 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'warehouse' (base.py:2619)
2025-12-13 13:22:27,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE TABLE "warehouse"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__1372347723" AS SELECT CAST("tanggal" AS DATE) AS "tanggal", CAST("produk" AS TEXT) AS "produk", CAST("total_pendapatan" AS INT) AS "total_pendapatan", CAST("mata_uang" AS TEXT) AS "mata_uang" FROM (SELECT "seed_pendapatan"."tanggal" AS "tanggal", "seed_pendapatan"."produk" AS "produk", "seed_pendapatan"."jumlah" * "seed_pendapatan"."harga" AS "total_pendapatan", 'IDR' AS "mata_uang" FROM "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_pendapatan__2581483422" AS "seed_pendapatan") AS "_subquery" (base.py:2619)
2025-12-13 13:22:27,018 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ COMMENT ON COLUMN "warehouse"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__1372347723"."total_pendapatan" IS 'Transformasi: Perkalian kolom' (base.py:2619)
2025-12-13 13:22:27,020 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ COMMENT ON COLUMN "warehouse"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__1372347723"."mata_uang" IS 'Transformasi: Menambah kolom baru' (base.py:2619)
2025-12-13 13:22:27,022 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-12 00:00:00, 2025-12-13 00:00:00) for snapshot SnapshotId<"warehouse"."proyek_etl_saya"."pendapatan_harian": 3265057870> (facade.py:637)
2025-12-13 13:22:27,022 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."proyek_etl_saya"."pendapatan_harian": 3265057870> (interval.py:215)
2025-12-13 13:22:27,056 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-13 13:22:27,057 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:167)
2025-12-13 13:22:27,097 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:123)
2025-12-13 13:22:27,120 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-13 13:22:27,127 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'warehouse.sqlmesh_example' (evaluator.py:1449)
2025-12-13 13:22:27,127 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE SCHEMA IF NOT EXISTS "warehouse"."sqlmesh_example" (base.py:2619)
2025-12-13 13:22:27,129 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'warehouse.proyek_etl_saya' (evaluator.py:1449)
2025-12-13 13:22:27,129 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE SCHEMA IF NOT EXISTS "warehouse"."proyek_etl_saya" (base.py:2619)
2025-12-13 13:22:27,132 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.sqlmesh_example (evaluator.py:1616)
2025-12-13 13:22:27,133 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:27,134 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:27,138 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'warehouse' AND table_schema = 'sqlmesh_example') AND table_name IN ('incremental_model', 'full_model', 'seed_model', 'seed_pendapatan') (base.py:2619)
2025-12-13 13:22:27,155 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.proyek_etl_saya (evaluator.py:1616)
2025-12-13 13:22:27,155 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:27,157 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-13 13:22:27,164 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'warehouse' AND table_schema = 'proyek_etl_saya') AND table_name IN ('pendapatan_harian') (base.py:2619)
2025-12-13 13:22:27,184 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'warehouse.sqlmesh_example.seed_model' to point at table 'warehouse.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2437004170' (evaluator.py:1988)
2025-12-13 13:22:27,190 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE VIEW "warehouse"."sqlmesh_example"."seed_model" AS SELECT * FROM "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" (base.py:2619)
2025-12-13 13:22:27,202 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'warehouse.sqlmesh_example.seed_pendapatan' to point at table 'warehouse.sqlmesh__sqlmesh_example.sqlmesh_example__seed_pendapatan__2581483422' (evaluator.py:1988)
2025-12-13 13:22:27,205 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE VIEW "warehouse"."sqlmesh_example"."seed_pendapatan" AS SELECT * FROM "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_pendapatan__2581483422" (base.py:2619)
2025-12-13 13:22:27,216 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'warehouse.proyek_etl_saya.pendapatan_harian' to point at table 'warehouse.sqlmesh__proyek_etl_saya.proyek_etl_saya__pendapatan_harian__1372347723' (evaluator.py:1988)
2025-12-13 13:22:27,219 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE VIEW "warehouse"."proyek_etl_saya"."pendapatan_harian" AS SELECT * FROM "warehouse"."sqlmesh__proyek_etl_saya"."proyek_etl_saya__pendapatan_harian__1372347723" (base.py:2619)
2025-12-13 13:22:27,223 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ COMMENT ON COLUMN "warehouse"."proyek_etl_saya"."pendapatan_harian"."total_pendapatan" IS 'Transformasi: Perkalian kolom' (base.py:2619)
2025-12-13 13:22:27,225 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ COMMENT ON COLUMN "warehouse"."proyek_etl_saya"."pendapatan_harian"."mata_uang" IS 'Transformasi: Menambah kolom baru' (base.py:2619)
2025-12-13 13:22:27,233 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'warehouse.sqlmesh_example.incremental_model' to point at table 'warehouse.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:1988)
2025-12-13 13:22:27,238 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE VIEW "warehouse"."sqlmesh_example"."incremental_model" AS SELECT * FROM "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" (base.py:2619)
2025-12-13 13:22:27,247 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'warehouse.sqlmesh_example.full_model' to point at table 'warehouse.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:1988)
2025-12-13 13:22:27,248 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: 4f40ffcb8e134a5c9d99b322803879ba */ CREATE OR REPLACE VIEW "warehouse"."sqlmesh_example"."full_model" AS SELECT * FROM "warehouse"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-12-13 13:22:27,264 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-13 13:22:27,264 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-12-13 13:22:27,355 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
